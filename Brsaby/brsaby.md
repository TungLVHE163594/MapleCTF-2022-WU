# Brsaby

Source code 
```Python
from Crypto.Util.number import getPrime, bytes_to_long
from secret import FLAG

msg = bytes_to_long(FLAG)
p = getPrime(512)
q = getPrime(512)
N = p*q
e = 0x10001
enc = pow(msg, e, N)
hint = p**4 - q**3

print(f"{N = }")
print(f"{e = }")
print(f"{enc = }")
print(f"{hint = }")

'''
N = 134049493752540418773065530143076126635445393203564220282068096099004424462500237164471467694656029850418188898633676218589793310992660499303428013844428562884017060683631593831476483842609871002334562252352992475614866865974358629573630911411844296034168928705543095499675521713617474013653359243644060206273
e = 65537
enc = 110102068225857249266317472106969433365215711224747391469423595211113736904624336819727052620230568210114877696850912188601083627767033947343144894754967713943008865252845680364312307500261885582194931443807130970738278351511194280306132200450370953028936210150584164591049215506801271155664701637982648648103
hint = 20172108941900018394284473561352944005622395962339433571299361593905788672168045532232800087202397752219344139121724243795336720758440190310585711170413893436453612554118877290447992615675653923905848685604450760355869000618609981902108252359560311702189784994512308860998406787788757988995958832480986292341328962694760728098818022660328680140765730787944534645101122046301434298592063643437213380371824613660631584008711686240103416385845390125711005079231226631612790119628517438076962856020578250598417110996970171029663545716229258911304933901864735285384197017662727621049720992964441567484821110407612560423282
'''
```

Chúng ta có N = pq và 'hint' từ source 
```Python
hint = p**4 - q**3
```
Ở đây chúng ta có 2 hướng giải bằng cách giải hệ phương trình 2 ẩn hoặc phương trình 1 ẩn. 
Trong Wu này mình sẽ sử dụng giải phương trình 1 ẩn để tìm p và q. 
Gọi hint là h cho gọn, ta có 

```
h = p^4 - q^3
<=> hp^3= p^7 - p^3q^3
<=> p^7 - hp^3 - n^3 = 0
```
Sau khi biến đổi chúng ta có 1 phương trình 1 ẩn bậc 7. 
Bằng cách sử dụng sympy, chúng ta giải ra được p và q 
```Python
p = symbols('p')
P = solve([p**7 - hint*p**3 - N**3], p)[0][0]
Q = N//P
```

Có p và q, chúng ta tính phi, d, và tìm được Flag
```Python
phi = (P-1)*(Q-1)
d = pow(e,-1,int(phi))
msg = pow(enc,d,N)
print(long_to_bytes(msg))
```

##Source
```Python
from Crypto.Util.number import long_to_bytes
from sympy import symbols, solve

N = 134049493752540418773065530143076126635445393203564220282068096099004424462500237164471467694656029850418188898633676218589793310992660499303428013844428562884017060683631593831476483842609871002334562252352992475614866865974358629573630911411844296034168928705543095499675521713617474013653359243644060206273
e = 65537
enc = 110102068225857249266317472106969433365215711224747391469423595211113736904624336819727052620230568210114877696850912188601083627767033947343144894754967713943008865252845680364312307500261885582194931443807130970738278351511194280306132200450370953028936210150584164591049215506801271155664701637982648648103
hint = 20172108941900018394284473561352944005622395962339433571299361593905788672168045532232800087202397752219344139121724243795336720758440190310585711170413893436453612554118877290447992615675653923905848685604450760355869000618609981902108252359560311702189784994512308860998406787788757988995958832480986292341328962694760728098818022660328680140765730787944534645101122046301434298592063643437213380371824613660631584008711686240103416385845390125711005079231226631612790119628517438076962856020578250598417110996970171029663545716229258911304933901864735285384197017662727621049720992964441567484821110407612560423282

p = symbols('p')
P = solve([p**7 - hint*p**3 - N**3], p)[0][0]
Q = N//P

phi = (P-1)*(Q-1)
d = pow(e,-1,int(phi))
msg = pow(enc,d,N)
print(long_to_bytes(msg))
```
